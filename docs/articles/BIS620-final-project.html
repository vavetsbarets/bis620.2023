<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BIS620-final-project • bis620.2023</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BIS620-final-project">
<meta property="og:description" content="bis620.2023">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bis620.2023</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BIS620-final-project.html">BIS620-final-project</a>
    </li>
    <li>
      <a href="../articles/spectral-signatures.html">Spectral Signatures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BIS620-final-project</h1>
            
      
      
      <div class="hidden name"><code>BIS620-final-project.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># importing the created package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bis620.2023</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># importing all the other needed libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.3.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.2, GDAL 3.6.2, PROJ 9.2.0; sf_use_s2() is TRUE</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html" class="external-link">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.3.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span> </span>
<span><span class="co">#&gt; Loading required package: viridisLite</span></span></code></pre></div>
<div class="section level2">
<h2 id="bis620-final-project">BIS620 final project<a class="anchor" aria-label="anchor" href="#bis620-final-project"></a>
</h2>
<div class="section level3">
<h3 id="interstate-mutual-impact-of-unemployment-in-the-us">Interstate mutual impact of unemployment in the US<a class="anchor" aria-label="anchor" href="#interstate-mutual-impact-of-unemployment-in-the-us"></a>
</h3>
<div class="section level4">
<h4 id="vladimir-averin">Vladimir Averin<a class="anchor" aria-label="anchor" href="#vladimir-averin"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="background-and-motivation">Background and motivation<a class="anchor" aria-label="anchor" href="#background-and-motivation"></a>
</h3>
<p>Unemployment is a key factor which measures the social welfare and
prosperity. At the same time, this measure is a key component of the
monetary policy in the US. The US targets inflation, so the inflation
spikes are usually are cured by raising the key rate. However, increase
in the key rate tend to raise the unemployment, thus the US carefully
analyses the dynamics of unemployment in order not to cause a spike in
unemployment by conducting a contractionary monetary policy. This
motivated me to study the US unemployment data.</p>
<p>Social vulnerability data provides a detailed US census data split by
FIPS. I was motivated to work with the spatial data and analyse
unemployment using such data. I was also interested in analysing the
geographical dynamics of the unemployment. Specifically, whether the
unemployment in some region can be affected by neighboring states or
unemployment is more or less stable throughout the whole state with some
state-specific mean value. So I set the goal of determining whether
there is an impact of state on each other’s unemployment rates.</p>
</div>
<div class="section level3">
<h3 id="research-question">Research question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h3>
<p>There are many ways to estimate how the states affect the
unemployment in the other areas. Given that the have cross-sectional
data (we could have at most the panel data with just several years which
may not be enough for the panel data analysis), I came up with the idea
to split the states onto counties and assume that the closer some county
of the state to some other state, the more impact this other state
should have on this county. Thus, inside some state I can compare the
unemployment of the counties far away from this other state with the
rates of the counties close to this other state and suggest the average
difference in the unemployment rate between these two groups of counties
is associated with the effect of this other state.</p>
<p>Thus, the broad research question is whether the states affect the
unemployment in the other states. The more specific research question
relevant to my work is whether the proximity to some state affects the
unemployment rate.</p>
</div>
<div class="section level3">
<h3 id="plan">Plan<a class="anchor" aria-label="anchor" href="#plan"></a>
</h3>
<p>In this work I plan to estimate the effect of all states on each
county. Thus, I need the unemployment data on a county level. This is
provided by the social vulnerability data. At the same time to do my
analysis I need to calculate the distance of each county of the US to
each state of the US. I am going to use geometry (coordinate)
information provided by the social vulnerability data. In the next
section I am going to provide in detail how I constructed the dataset
for the modelling.</p>
</div>
<div class="section level3">
<h3 id="data-cleaning-and-exploration">Data cleaning and exploration<a class="anchor" aria-label="anchor" href="#data-cleaning-and-exploration"></a>
</h3>
<div class="section level4">
<h4 id="initial-preprocessing-and-creating-the-package-dataset">Initial preprocessing and creating the package dataset<a class="anchor" aria-label="anchor" href="#initial-preprocessing-and-creating-the-package-dataset"></a>
</h4>
<p>In this section I am going to explain how I used initial social
vulnerability data we used in class to create my final modelling
dataset.</p>
<p>First of all, I want to note that the initial dataset is too large to
be deployed in Github so I first did some preprocessing to this data,
saved preprocessed data and then I used this preprocessed data as the
package dataset. You can see the preprocessing code below which I don’t
run as I didn’t save the initial SVI2018_US_tract.shp data in the
package due to its large memory (I cannot store such large files in
GitHub).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># d_county &lt;- read_sf(file.path("2018-data", "SVI2018_US_tract.shp")) |&gt;</span></span>
<span><span class="co">#   mutate_if(is.numeric, ~ if_else(.x == -999, NA, .x)) |&gt; </span></span>
<span><span class="co">#   select(STATE, COUNTY, E_TOTPOP, E_UNEMP) |&gt; </span></span>
<span><span class="co">#   # no information about unemployment in Rio Arriba county, New Mexico</span></span>
<span><span class="co">#     # deleting this county from analysis</span></span>
<span><span class="co">#   filter(!is.na(E_UNEMP)) |&gt; </span></span>
<span><span class="co">#   group_by(STATE, COUNTY) |&gt; </span></span>
<span><span class="co">#   summarize(unemp = sum(E_UNEMP, na.rm = TRUE), pop = sum(E_TOTPOP, na.rm = TRUE))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># st_write(d_county, "SVI2018_US_tract_modified.shp")</span></span></code></pre></div>
<p>We can see that I first replaced -999 onto NA as we did in class as
initially NA values were marked as -999. Then I selected only needed
variables for the further analysis: that is the information about state,
county, total population and total number of unemployed people for each
FIPS. Note that I also keep geometry column. As this is sf data frame,
geometry column is saved automatically, I don’t need to select it every
time. Then I deleted one county Rio Arriba from the analysis because the
data for this county was completely missing (in fact, the data was
missing only in this county). The initial SVI2018_US_tract.shp has the
information on the FIPS level, but I think that single FIPS are too
small for the analysis (very large margin of errors for the unemployment
estimates). Thus, I decided to use county-level data, so I grouped all
the data by county. Finally, I saved the resulted dataset in a file
<strong>SVI2018_US_tract_modified.shp</strong> and I made such dataset
to be the package dataset and named it <strong>counties</strong>.</p>
</div>
<div class="section level4">
<h4 id="further-cleaning-and-initial-visualization">Further cleaning and initial visualization<a class="anchor" aria-label="anchor" href="#further-cleaning-and-initial-visualization"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># replacing the spaces with _ for the convenience</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">STATE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">counties</span><span class="op">$</span><span class="va">STATE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># state-level data</span></span>
<span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">counties</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">STATE</span>, <span class="va">unemp</span>, <span class="va">pop</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">STATE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>unemp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">unemp</span><span class="op">)</span>, pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_union assumes that they are</span></span>
<span><span class="co">#&gt; planar</span></span>
<span></span>
<span><span class="co"># unemployment rate for each state</span></span>
<span><span class="va">states</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">$</span><span class="va">unemp</span> <span class="op">/</span> <span class="va">states</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># vizualization of the unemployment of the state-level</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geographical_visualizer.html">geographical_visualizer</a></span><span class="op">(</span><span class="va">states</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">STATE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ALASKA'</span>, <span class="st">'HAWAII'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              <span class="st">'unemployment_rate'</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="BIS620-final-project_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Let’s do some Exploratory data analysis. On the state-level, we can
observe (figure above) that unemployment rate is quite stable ranging
from 1.5 to 4%. In general the unemployment is slightly lower in the
center-north states of the US. In general, the change in unemployment
between neighbouring states is quite smooth. So we may obtain the
results that there are some effect of states on the unemployment of the
other states in our models. The unemployment in Utah seems to be
unexpectedly much lower than in the neighboring states. I will make are
more detailed analysis of this region later on.</p>
<p>Note, the function geographical_vizualizer() is the function of the
package bis620.2023.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># county-level analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">counties</span><span class="op">$</span><span class="va">unemp</span> <span class="op">/</span> <span class="va">counties</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="BIS620-final-project_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># percentage of outliers counties</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">counties</span><span class="op">[</span><span class="va">counties</span><span class="op">$</span><span class="va">unemp</span> <span class="op">/</span> <span class="va">counties</span><span class="op">$</span><span class="va">pop</span> <span class="op">&gt;</span> <span class="fl">0.05</span>, <span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">counties</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt; [1] 2.54696</span></span></code></pre></div>
<p>As for the counties, the range is more or less the similar
(considering that there are 3000 counties VS 51 states, so slightly
wider range is natural). There are some outliers (2.5%), but it’s also
kinda natural for such variable bounded below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 51 states, not 50!!!</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">STATE</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ALABAMA"              "ALASKA"               "ARIZONA"             </span></span>
<span><span class="co">#&gt;  [4] "ARKANSAS"             "CALIFORNIA"           "COLORADO"            </span></span>
<span><span class="co">#&gt;  [7] "CONNECTICUT"          "DELAWARE"             "DISTRICT_OF_COLUMBIA"</span></span>
<span><span class="co">#&gt; [10] "FLORIDA"              "GEORGIA"              "HAWAII"              </span></span>
<span><span class="co">#&gt; [13] "IDAHO"                "ILLINOIS"             "INDIANA"             </span></span>
<span><span class="co">#&gt; [16] "IOWA"                 "KANSAS"               "KENTUCKY"            </span></span>
<span><span class="co">#&gt; [19] "LOUISIANA"            "MAINE"                "MARYLAND"            </span></span>
<span><span class="co">#&gt; [22] "MASSACHUSETTS"        "MICHIGAN"             "MINNESOTA"           </span></span>
<span><span class="co">#&gt; [25] "MISSISSIPPI"          "MISSOURI"             "MONTANA"             </span></span>
<span><span class="co">#&gt; [28] "NEBRASKA"             "NEVADA"               "NEW_HAMPSHIRE"       </span></span>
<span><span class="co">#&gt; [31] "NEW_JERSEY"           "NEW_MEXICO"           "NEW_YORK"            </span></span>
<span><span class="co">#&gt; [34] "NORTH_CAROLINA"       "NORTH_DAKOTA"         "OHIO"                </span></span>
<span><span class="co">#&gt; [37] "OKLAHOMA"             "OREGON"               "PENNSYLVANIA"        </span></span>
<span><span class="co">#&gt; [40] "RHODE_ISLAND"         "SOUTH_CAROLINA"       "SOUTH_DAKOTA"        </span></span>
<span><span class="co">#&gt; [43] "TENNESSEE"            "TEXAS"                "UTAH"                </span></span>
<span><span class="co">#&gt; [46] "VERMONT"              "VIRGINIA"             "WASHINGTON"          </span></span>
<span><span class="co">#&gt; [49] "WEST_VIRGINIA"        "WISCONSIN"            "WYOMING"</span></span></code></pre></div>
<p>Note, there are 51 states in the data, not 50. Because for some
reason the District of Columbia marked as the separate state. I decided
not to change that.</p>
</div>
<div class="section level4">
<h4 id="feature-extraction-for-the-model">Feature extraction for the model<a class="anchor" aria-label="anchor" href="#feature-extraction-for-the-model"></a>
</h4>
<p>Now it’s time to add distances between each county and each state to
the data. I am going to find these distances using the coordinates.
Specifically, I am going to find the distance between a county i (from
state k) and some other state j in the following way: 1) find a center
point of the county i using st_centroid() function applied to the
geometry 2) Split the state j onto counties and find the center point of
each county like I did in 1) 3) Calculate distances between center point
of county i and each county of state j 4) Choose the smallest distance.
This smallest distance will be treated as the distance between a county
i and state j.</p>
<p>The function feature_extraction() of the bis620.2023 calculates the
distance to every state for each county of the US. I am going to call it
below</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adding the coordinate of the center of the county for each county</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">centr_coord</span> <span class="op">&lt;-</span> <span class="va">counties</span><span class="op">$</span><span class="va">geometry</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_centroid.sfc(counties$geometry): st_centroid does not give</span></span>
<span><span class="co">#&gt; correct centroids for longitude/latitude data</span></span>
<span></span>
<span><span class="co"># adding unemployment rate for each county</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">&lt;-</span> <span class="va">counties</span><span class="op">$</span><span class="va">unemp</span> <span class="op">/</span> <span class="va">counties</span><span class="op">$</span><span class="va">pop</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># applyting feature_extraction() function and removing all </span></span>
<span>  <span class="co"># geometry columns with coordinate (we don't needed them for the modelling anymore)</span></span>
<span><span class="va">counties_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_extraction.html">feature_extraction</a></span><span class="op">(</span><span class="va">counties</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">centr_coord</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># observing the updated dataset</span></span>
<span><span class="va">counties_features</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 56</span></span>m</span>
<span><span class="co">#&gt;   STATE   COUNTY  unemp    pop unemployment_rate dist_to_ALABAMA dist_to_ALASKA</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ALABAMA Autauga  <span style="text-decoration: underline;">1</span>065  <span style="text-decoration: underline;">55</span>200              1.93               0       2<span style="text-decoration: underline;">762</span>765.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ALABAMA Baldwin  <span style="text-decoration: underline;">4</span>343 <span style="text-decoration: underline;">208</span>107              2.09               0       2<span style="text-decoration: underline;">891</span>480.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ALABAMA Barbour   918  <span style="text-decoration: underline;">25</span>782              3.56               0       2<span style="text-decoration: underline;">885</span>360.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ALABAMA Bibb      658  <span style="text-decoration: underline;">22</span>527              2.92               0       2<span style="text-decoration: underline;">695</span>682.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ALABAMA Blount    909  <span style="text-decoration: underline;">57</span>645              1.58               0       2<span style="text-decoration: underline;">627</span>946.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ALABAMA Bullock   490  <span style="text-decoration: underline;">10</span>352              4.73               0       2<span style="text-decoration: underline;">847</span>930.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> ALABAMA Butler    567  <span style="text-decoration: underline;">20</span>025              2.83               0       2<span style="text-decoration: underline;">836</span>859.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 49 more variables: dist_to_ARIZONA &lt;dbl&gt;, dist_to_ARKANSAS &lt;dbl&gt;,</span></span>9m</span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_CALIFORNIA &lt;dbl&gt;, dist_to_COLORADO &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_CONNECTICUT &lt;dbl&gt;, dist_to_DELAWARE &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_DISTRICT_OF_COLUMBIA &lt;dbl&gt;, dist_to_FLORIDA &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_GEORGIA &lt;dbl&gt;, dist_to_HAWAII &lt;dbl&gt;, dist_to_IDAHO &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_ILLINOIS &lt;dbl&gt;, dist_to_INDIANA &lt;dbl&gt;, dist_to_IOWA &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   dist_to_KANSAS &lt;dbl&gt;, dist_to_KENTUCKY &lt;dbl&gt;, dist_to_LOUISIANA &lt;dbl&gt;, …</span></span>9m</span></code></pre></div>
<p>So now for each county in the US we have variables dist_to_ALABAMA,
dist_to_ALASKA, …, dist_to_WYOMING, which indicate the distance to the
specified state in meters.</p>
</div>
<div class="section level4">
<h4 id="preparing-y-and-x-for-the-modelling">Preparing y and X for the modelling<a class="anchor" aria-label="anchor" href="#preparing-y-and-x-for-the-modelling"></a>
</h4>
<p>As for the y variable it is unemployment rate (or centered
unemployment rate), so not so many transformation needed. As for the X
variables, I propose some transformations for the better fit of models
and interpretation which are not easy to understand at first glance. In
fact, I am going to introduce the proximity variable
<strong>proximity_to_STATE</strong> (where STATE is any of the 51
states) defined as: <span class="math display">\[
proximity\_to\_STATE = log(300001) - log(1 + min(distance\_to\_STATE,
300000))
\]</span> What is the interpretation of such variable? First of all, if
the distance is more than 300 km or more, I consider this distance is
‘not close at all’ so proximity is zero. If the distance is less than
300 km, then the proximity variable is positive and the distance is zero
then the proximity is maximum = log(300001). Note that I included the
log transformation as I believe that the constant effect of % change is
more likely than the constant effect of absolute value change (i.e
change in unemployment if distance changes from 20 to 40 is likely to
match the change in unemployment if distance changes from 200 to 400
rather than match the change if distance changes from 200 to 220). Then
the last part is minus sign. This is for interpretation and making
proximity the variable such that the bigger it is the bigger the rate of
proximity (i.e. the closer the objects) are.</p>
<p>Note that if the county is in the state, for example, ALABAMA, then
proximity_to_ALABAMA is set to 0. This is done to separate the effect of
other states and the effect of the state in which the county is in. The
effect of the “home state” will be accounted for by creating a dummy
variable or by subtracting the mean unemployment of the state from the
unemployment of the county.</p>
<p>The function transformation_modeling() of the bis620.2023 package
replaces distance_to_STATE variables onto proximity_to_STATE variables
and additionally adds the dummy variable for each state (will be helpful
in the modeling).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generating features for X</span></span>
<span><span class="va">df_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transformation_modeling.html">transformation_modeling</a></span><span class="op">(</span><span class="va">counties_features</span><span class="op">)</span></span>
<span><span class="va">df_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 106</span></span>m</span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   STATE [1]</span></span></span>
<span><span class="co">#&gt;   proximity_to_ALABAMA proximity_to_ALASKA proximity_to_ARIZONA</span></span>
<span><span class="co">#&gt;                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>                    0                   0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 103 more variables: proximity_to_ARKANSAS &lt;dbl&gt;,</span></span>9m</span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_CALIFORNIA &lt;dbl&gt;, proximity_to_COLORADO &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_CONNECTICUT &lt;dbl&gt;, proximity_to_DELAWARE &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_DISTRICT_OF_COLUMBIA &lt;dbl&gt;, proximity_to_FLORIDA &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_GEORGIA &lt;dbl&gt;, proximity_to_HAWAII &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_IDAHO &lt;dbl&gt;, proximity_to_ILLINOIS &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   proximity_to_INDIANA &lt;dbl&gt;, proximity_to_IOWA &lt;dbl&gt;, …</span></span>9m</span></code></pre></div>
<p>In addition to that I am adding another variable which will be useful
in modelling</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_model</span><span class="op">$</span><span class="va">unemp_rate_centered</span> <span class="op">&lt;-</span> <span class="va">df_model</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="va">df_model</span><span class="op">$</span><span class="va">avg_state_unemp</span></span></code></pre></div>
<p>Now df_model has all the variables for the modelling</p>
</div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<p>Now let us move on to the modelling. I am going to propose two
versions of the linear models. In each of the models the proximity
variables will be present. Note that the significant coefficient to the
proximity variable indicates that the proximity to some other states is
associated with the unemployment, so we can propose the hypothesis that
some other state affect the unemployment in the other state by being
close to some counties of the state.</p>
<p>So let’s define and fit such models. In model 1 y variable is
unemployment_rate and X variables are all proximity variables and state
dummy variables. In model 2 y variable is unemp_rate_centered and X
variable are all proximity variables and constant. Note that the final
versions of the model will contain only selected variables. The
variables will selected using forward selection and using AIC metric. In
both cases the null model will be y ~ 1. Note the forward selection is
done by forward_selection_linreg function of the package bis620.2023.
Now let’s fit both these models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># defining X and y variables for the models</span></span>
<span><span class="va">X_cols_model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">df_model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">STATE</span>, <span class="va">unemployment_rate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span><span class="va">y_col_model1</span> <span class="op">&lt;-</span> <span class="st">"unemployment_rate"</span></span>
<span><span class="va">X_cols_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">49</span><span class="op">]</span></span>
<span><span class="va">y_col_model2</span> <span class="op">&lt;-</span> <span class="st">"unemp_rate_centered"</span></span>
<span></span>
<span><span class="co"># getting model 1 using the initial variables and forward selection</span></span>
<span><span class="va">fs_df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forward_selection_linreg.html">forward_selection_linreg</a></span><span class="op">(</span><span class="va">df_model</span>, <span class="va">X_cols_model1</span>, <span class="va">y_col_model1</span><span class="op">)</span></span>
<span><span class="co"># choosing the optimal model based on aic</span></span>
<span><span class="va">argmin_ind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">fs_df1</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></span>
<span><span class="co"># generating the formula and creating the model object</span></span>
<span><span class="va">formula1fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">fs_df1</span><span class="op">$</span><span class="va">var</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">argmin_ind1</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span><span class="va">formula1fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">y_col_model1</span>, <span class="st">'~'</span>, <span class="va">formula1fs</span><span class="op">)</span></span>
<span><span class="va">model1fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formula1fs</span>, data <span class="op">=</span> <span class="va">df_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># getting model 2 using the initial variables and forward selection</span></span>
<span><span class="va">fs_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forward_selection_linreg.html">forward_selection_linreg</a></span><span class="op">(</span><span class="va">df_model</span>, <span class="va">X_cols_model2</span>, <span class="va">y_col_model2</span><span class="op">)</span></span>
<span><span class="va">argmin_ind2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">fs_df2</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></span>
<span><span class="va">formula2fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">fs_df2</span><span class="op">$</span><span class="va">var</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">argmin_ind2</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span><span class="va">formula2fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">y_col_model2</span>, <span class="st">'~'</span>, <span class="va">formula2fs</span><span class="op">)</span></span>
<span><span class="va">model2fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formula2fs</span>, data <span class="op">=</span> <span class="va">df_model</span><span class="op">)</span></span></code></pre></div>
<p>Now we have 2 final models. Let us analyse the results and
interpretations in the next section</p>
</div>
<div class="section level3">
<h3 id="interpretation-and-conclusions">Interpretation and conclusions<a class="anchor" aria-label="anchor" href="#interpretation-and-conclusions"></a>
</h3>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>Let’s look at the summary of the models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model1fs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = formula1fs, data = df_model)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.9784 -0.5583 -0.0831  0.4582  8.5508 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                        2.54219    0.04284  59.339  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; in_ALABAMA                         0.46484    0.14502   3.205 0.001363 ** </span></span>
<span><span class="co">#&gt; in_ALASKA                          2.09510    0.18275  11.464  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; in_ARIZONA                         0.96801    0.25628   3.777 0.000162 ***</span></span>
<span><span class="co">#&gt; in_CALIFORNIA                      0.75603    0.13270   5.697 1.33e-08 ***</span></span>
<span><span class="co">#&gt; in_COLORADO                        0.26176    0.13887   1.885 0.059527 .  </span></span>
<span><span class="co">#&gt; in_CONNECTICUT                     0.52955    0.34498   1.535 0.124879    </span></span>
<span><span class="co">#&gt; in_FLORIDA                         0.29825    0.12424   2.400 0.016432 *  </span></span>
<span><span class="co">#&gt; in_GEORGIA                         0.52507    0.12911   4.067 4.88e-05 ***</span></span>
<span><span class="co">#&gt; in_HAWAII                         -0.67106    0.43000  -1.561 0.118723    </span></span>
<span><span class="co">#&gt; in_ILLINOIS                        0.31282    0.11666   2.681 0.007372 ** </span></span>
<span><span class="co">#&gt; in_KANSAS                         -0.58639    0.11185  -5.243 1.69e-07 ***</span></span>
<span><span class="co">#&gt; in_KENTUCKY                        0.87413    0.16263   5.375 8.22e-08 ***</span></span>
<span><span class="co">#&gt; in_MICHIGAN                        0.57811    0.11657   4.959 7.45e-07 ***</span></span>
<span><span class="co">#&gt; in_MINNESOTA                      -0.53675    0.11960  -4.488 7.46e-06 ***</span></span>
<span><span class="co">#&gt; in_MISSISSIPPI                     1.09531    0.12392   8.838  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; in_MONTANA                        -0.53850    0.13804  -3.901 9.79e-05 ***</span></span>
<span><span class="co">#&gt; in_NEBRASKA                       -0.73962    0.13247  -5.583 2.57e-08 ***</span></span>
<span><span class="co">#&gt; in_NEW_JERSEY                      0.73604    0.21303   3.455 0.000558 ***</span></span>
<span><span class="co">#&gt; in_NORTH_CAROLINA                  0.84984    0.16256   5.228 1.83e-07 ***</span></span>
<span><span class="co">#&gt; in_NORTH_DAKOTA                   -0.86990    0.15436  -5.636 1.90e-08 ***</span></span>
<span><span class="co">#&gt; in_OREGON                          0.44457    0.16882   2.633 0.008497 ** </span></span>
<span><span class="co">#&gt; in_SOUTH_CAROLINA                  0.66090    0.15668   4.218 2.54e-05 ***</span></span>
<span><span class="co">#&gt; in_TENNESSEE                      -0.26352    0.13993  -1.883 0.059770 .  </span></span>
<span><span class="co">#&gt; in_TEXAS                          -0.05109    0.07644  -0.668 0.503980    </span></span>
<span><span class="co">#&gt; in_UTAH                           -0.74203    0.19468  -3.812 0.000141 ***</span></span>
<span><span class="co">#&gt; in_WEST_VIRGINIA                   0.45537    0.16783   2.713 0.006698 ** </span></span>
<span><span class="co">#&gt; proximity_to_ARIZONA               1.42840    0.33275   4.293 1.82e-05 ***</span></span>
<span><span class="co">#&gt; proximity_to_ARKANSAS              0.36965    0.06843   5.402 7.09e-08 ***</span></span>
<span><span class="co">#&gt; proximity_to_CALIFORNIA            0.37412    0.20379   1.836 0.066483 .  </span></span>
<span><span class="co">#&gt; proximity_to_DISTRICT_OF_COLUMBIA -0.19322    0.08665  -2.230 0.025832 *  </span></span>
<span><span class="co">#&gt; proximity_to_FLORIDA               0.17852    0.11220   1.591 0.111701    </span></span>
<span><span class="co">#&gt; proximity_to_ILLINOIS             -0.17852    0.05475  -3.260 0.001124 ** </span></span>
<span><span class="co">#&gt; proximity_to_INDIANA              -0.10225    0.07143  -1.431 0.152412    </span></span>
<span><span class="co">#&gt; proximity_to_KANSAS               -0.32103    0.07379  -4.351 1.40e-05 ***</span></span>
<span><span class="co">#&gt; proximity_to_KENTUCKY              0.18380    0.06497   2.829 0.004702 ** </span></span>
<span><span class="co">#&gt; proximity_to_MINNESOTA            -0.46498    0.07236  -6.426 1.52e-10 ***</span></span>
<span><span class="co">#&gt; proximity_to_MISSISSIPPI           0.40862    0.07417   5.509 3.91e-08 ***</span></span>
<span><span class="co">#&gt; proximity_to_MONTANA              -0.19641    0.14905  -1.318 0.187673    </span></span>
<span><span class="co">#&gt; proximity_to_NEBRASKA             -0.21655    0.07799  -2.777 0.005525 ** </span></span>
<span><span class="co">#&gt; proximity_to_NEW_JERSEY            0.25853    0.08173   3.163 0.001576 ** </span></span>
<span><span class="co">#&gt; proximity_to_NEW_MEXICO           -0.28554    0.14099  -2.025 0.042928 *  </span></span>
<span><span class="co">#&gt; proximity_to_NORTH_CAROLINA        0.26454    0.06553   4.037 5.55e-05 ***</span></span>
<span><span class="co">#&gt; proximity_to_OHIO                 -0.18420    0.06653  -2.768 0.005666 ** </span></span>
<span><span class="co">#&gt; proximity_to_SOUTH_CAROLINA       -0.21868    0.09926  -2.203 0.027656 *  </span></span>
<span><span class="co">#&gt; proximity_to_SOUTH_DAKOTA         -0.22724    0.09666  -2.351 0.018795 *  </span></span>
<span><span class="co">#&gt; proximity_to_TENNESSEE            -0.33211    0.07065  -4.701 2.70e-06 ***</span></span>
<span><span class="co">#&gt; proximity_to_UTAH                 -0.45228    0.18959  -2.386 0.017112 *  </span></span>
<span><span class="co">#&gt; proximity_to_VIRGINIA              0.11810    0.06956   1.698 0.089667 .  </span></span>
<span><span class="co">#&gt; proximity_to_WYOMING              -0.15036    0.13578  -1.107 0.268218    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9567 on 3091 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2866, Adjusted R-squared:  0.2753 </span></span>
<span><span class="co">#&gt; F-statistic: 25.34 on 49 and 3091 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model2fs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = formula2fs, data = df_model)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.9144 -0.5575 -0.0811  0.4564  8.9394 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                        0.02258    0.02396   0.942  0.34616    </span></span>
<span><span class="co">#&gt; proximity_to_ARIZONA               0.96878    0.32753   2.958  0.00312 ** </span></span>
<span><span class="co">#&gt; proximity_to_ARKANSAS              0.29845    0.06177   4.832 1.42e-06 ***</span></span>
<span><span class="co">#&gt; proximity_to_DISTRICT_OF_COLUMBIA -0.23196    0.08379  -2.768  0.00567 ** </span></span>
<span><span class="co">#&gt; proximity_to_FLORIDA               0.19601    0.08538   2.296  0.02176 *  </span></span>
<span><span class="co">#&gt; proximity_to_GEORGIA              -0.11551    0.05711  -2.023  0.04320 *  </span></span>
<span><span class="co">#&gt; proximity_to_KANSAS               -0.15486    0.06162  -2.513  0.01202 *  </span></span>
<span><span class="co">#&gt; proximity_to_MINNESOTA            -0.16706    0.06627  -2.521  0.01176 *  </span></span>
<span><span class="co">#&gt; proximity_to_NEBRASKA             -0.10251    0.06555  -1.564  0.11793    </span></span>
<span><span class="co">#&gt; proximity_to_NEW_JERSEY            0.11473    0.07807   1.470  0.14179    </span></span>
<span><span class="co">#&gt; proximity_to_NEW_MEXICO           -0.23341    0.12474  -1.871  0.06143 .  </span></span>
<span><span class="co">#&gt; proximity_to_NORTH_CAROLINA        0.12397    0.05250   2.361  0.01828 *  </span></span>
<span><span class="co">#&gt; proximity_to_OHIO                 -0.08121    0.05211  -1.558  0.11922    </span></span>
<span><span class="co">#&gt; proximity_to_SOUTH_CAROLINA       -0.16177    0.06660  -2.429  0.01520 *  </span></span>
<span><span class="co">#&gt; proximity_to_TENNESSEE            -0.12818    0.04854  -2.641  0.00832 ** </span></span>
<span><span class="co">#&gt; proximity_to_VIRGINIA              0.13035    0.05087   2.562  0.01044 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.96 on 3125 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.02606,    Adjusted R-squared:  0.02139 </span></span>
<span><span class="co">#&gt; F-statistic: 5.575 on 15 and 3125 DF,  p-value: 2.231e-11</span></span></code></pre></div>
<p>We can see that in both models the proximity coefficients are close
to each other as they should be since the model specifications are
similar. The largest coefficient in absolute value among coefficients to
the proximity variables is the one to the proximity_to_ARIZONA variable.
If taking the second model the interpretation is as follows: if we are
in the range 100-300 km from Arizona, if we get exp(1) times closer to
Arizona (keeping the same distance from other states or the other states
are too far away and keeping the same state where are at) the
unemployment rate rises by 0.96 percentage points. The same
interpretation applies to other proximity variables, just replace the
state and the coefficient value. Overall, there are several significant
coefficients to proximity variables, so it can be suggested that the
distance to the certain state affects the unemployment which indicates
the association between unemployment of the county and the one in the
neighbouring state.</p>
</div>
<div class="section level4">
<h4 id="visual-interpretation">Visual interpretation<a class="anchor" aria-label="anchor" href="#visual-interpretation"></a>
</h4>
<p>In general, the positive (negative) significant coeffient imply that
as we get closer to some state the counties’ unemployment on average
increases (decreases). Let’s check this claim using visualization. Let’s
first check that for proximity_to_ARIZONA:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counties_flt</span> <span class="op">&lt;-</span> <span class="va">counties</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STATE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CALIFORNIA'</span>, <span class="st">'ARIZONA'</span>, <span class="st">'NEVADA'</span>, <span class="st">'UTAH'</span>, <span class="st">'COLORADO'</span>, <span class="st">'NEW_MEXICO'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geographical_visualizer.html">geographical_visualizer</a></span><span class="op">(</span><span class="va">counties_flt</span>, <span class="st">'unemployment_rate'</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="BIS620-final-project_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>As for Arizona, it seems that only in New Mexico the unemployment
rises as the counties are closer to Arizona, the unemployment increases.
Maybe it’s also the case for California, the unemployment there is
unstable there in general, so it’s hard to tell. So in some states some
increase in unemployment with the increase in proximity may be seen, but
it’s definitely not seen fo the states like Utah and Colorado. For these
states unemployment does not rise with the proximity to Arizona.</p>
<p>Let’s take the second example, let’s take proximity_to_ARKANSAS which
was also one of the largest and it’s extremely significant in both
models.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counties_flt2</span> <span class="op">&lt;-</span> <span class="va">counties</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STATE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ARKANSAS'</span>, <span class="st">'OKLAHOMA'</span>, <span class="st">'LOUISIANA'</span>, <span class="st">'MISSOURI'</span>, </span>
<span>                      <span class="st">'MISSISSIPPI'</span>, <span class="st">'TENNESSEE'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geographical_visualizer.html">geographical_visualizer</a></span><span class="op">(</span><span class="va">counties_flt2</span>, <span class="st">'unemployment_rate'</span><span class="op">)</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="BIS620-final-project_files/figure-html/unnamed-chunk-12-1.png" width="700">
Well, as for the Arkansas, it’s quite clearly seen that the counties
become slightly brighter in Oklahoma, Tennessee (just the border
counties become brighter), and Misouri as they get closer to Arkansas.
The same can be said for Mississippi. In Lousiana no “Arkansas effect”
is observed. So it can be suggested that proximity to Arkansas on
average increases the unemployment rate in the counties of the other
states.</p>
</div>
<div class="section level4">
<h4 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h4>
<p>Spatial data analysis was made to estimate the impact of the certain
state onto unemployment in the counties of the neighboring states which
are close to this certain state. Based on the presence of the
significant variables it can be suggested that some states indeed may
cause the increase or decrease the unemployment in the nearby counties
from the other states. Such analysis can be helpful in the general
analysis of the unemployment dynamics in the US. Some other models,
panel data (with many periods, to study the dynamics of unemployment)
and other spatial data techiques can be potentially used to make a
further analysis and more robust results with more specific suggestions
on how to control the unemployment rate in the US</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
